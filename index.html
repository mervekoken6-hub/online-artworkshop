<script>
const API_URL="https://script.google.com/macros/s/AKfycbwD4chBKNlbOIoymVZtPEYCx-YRhwA2hssBPZck-7695kRMN22xAtgSrW94Ck9HsdEJ0Q/exec";

const dict={
tr:{title:"Online Art Workshop",subtitle:"Kayıt Formu • Zoom linki WhatsApp’tan gönderilir",
name:"Ad Soyad",email:"E-posta",phone:"Telefon (WhatsApp)",date:"Tarih",time:"Seans Saati",
price:"Ücret",note:"Not",warn:"⚠️ Ödeme dekontunu WhatsApp üzerinden gönderiniz.<br>Zoom linki ödeme kontrolünden sonra paylaşılır.",
submit:"Kaydı Gönder",success:"✨ Kayıt Alındı"},
en:{title:"Online Art Workshop",subtitle:"Registration Form • Zoom link via WhatsApp",
name:"Full Name",email:"Email",phone:"Phone (WhatsApp)",date:"Date",time:"Session Time",
price:"Fee",note:"Note",warn:"⚠️ Please send payment receipt via WhatsApp.<br>Zoom link after verification.",
submit:"Submit Registration",success:"✨ Registration Received"},
fa:{title:"کارگاه آنلاین هنر",subtitle:"فرم ثبت‌نام • لینک زوم از واتساپ",
name:"نام و نام خانوادگی",email:"ایمیل",phone:"واتساپ",date:"تاریخ",time:"ساعت جلسه",
price:"هزینه",note:"یادداشت",warn:"⚠️ رسید پرداخت را از واتساپ ارسال کنید.<br>لینک زوم بعد از بررسی ارسال می‌شود.",
submit:"ارسال ثبت‌نام",success:"✨ ثبت‌نام انجام شد"}
};

function setLang(l){
document.documentElement.dir=(l==="fa")?"rtl":"ltr";
t_title.textContent=dict[l].title;
t_subtitle.textContent=dict[l].subtitle;
l_name.textContent=dict[l].name;
l_email.textContent=dict[l].email;
l_phone.textContent=dict[l].phone;
l_date.textContent=dict[l].date;
l_time.textContent=dict[l].time;
l_price.textContent=dict[l].price;
l_note.textContent=dict[l].note;
t_warn.innerHTML=dict[l].warn;
submitBtn.textContent=dict[l].submit;
t_success.textContent=dict[l].success;
document.querySelectorAll(".langbtn").forEach(b=>b.classList.toggle("active",b.dataset.lang===l));
}

document.querySelectorAll(".langbtn").forEach(b=>b.onclick=()=>setLang(b.dataset.lang));
setLang("tr");

registerForm.onsubmit = async (e)=>{
  e.preventDefault();
  submitBtn.disabled = true;
  submitBtn.textContent = "Gönderiliyor…";

  try{
    const res = await fetch(API_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        name:name.value,
        email:email.value,
        phone:phone.value,
        date:date.value,
        timeSlot:timeSlot.value,
        price:price.value,
        note:note.value
      })
    });

    if(!res.ok){
      throw new Error("Sunucuya ulaşılamadı");
    }

    const data = await res.json().catch(()=>({ok:true}));

    if(data.ok !== true){
      throw new Error("Kayıt alınamadı");
    }

    formCard.style.display="none";
    successCard.style.display="block";

  }catch(err){
    alert("Bir hata oluştu. Lütfen tekrar deneyin.");
    submitBtn.disabled = false;
    submitBtn.textContent = dict.tr.submit;
  }
};
</script>
